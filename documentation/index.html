<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>log_pipeline documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="./images/favicon.ico">
	   <link rel="stylesheet" href="./styles/style.css">
        <link rel="stylesheet" href="./styles/dark.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="./" class="navbar-brand">log_pipeline documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content getting-started">
                   <div class="content-data">

<p align="center">
  <a href="http://nestjs.com/" target="blank"><img src="https://nestjs.com/img/logo-small.svg" width="200" alt="Nest Logo" /></a>
</p>

<h2 id="description">Description</h2>
<p>This app is a pipeline that has two functionalities:</p>
<ul>
<li>get some logs from queue (kafka), and save them in database (elastic search), </li>
<li>search logs by some text</li>
</ul>
<p>Why I choose queue rather than http for logs injection?
If our server is offline, we lose the messages, but with queue the messages will still be in the queue until we acknowledge them</p>
<p>Why I use Kafka rather than pub/sub?</p>
<ul>
<li>Kafka is open source</li>
<li>Kafka can implement schema registry</li>
<li>Kafka work with partitions and parallelization works better</li>
<li>Kafka has retention process for messages, in contrasts with pub/sub when we acknowledge the message, it goes</li>
</ul>
<p> Why I choose Elasticsearch:</p>
<ul>
<li>Elasticsearch is no-sql so it is perfect for storing unstructured data</li>
<li>Elasticsearch is very powerfull for search, and very powerfull for data analyse so it&#39;s perfect for logs
 But Mongo could be also a good choise</li>
</ul>
<h2 id="installation">Installation</h2>
<p>No installation is needed if you&#39;re running the app via docker. If not you can run:</p>
<div><pre class="line-numbers"><code class="language-bash">npm ci</code></pre></div><h2 id="important">Important</h2>
<p>Be careful to increase your memory in docker desktop up to 4Gb to avoid crashing of elastic search container</p>
<h2 id="running-the-app">Running the app</h2>
<div><pre class="line-numbers"><code class="language-bash">docker compose up --build</code></pre></div><h2 id="postman">Postman</h2>
<p>You can import logs.postman_collection.json (from root project ) to postman to test this server</p>
<h2 id="note">Note</h2>
<p>I Implemented a producer for kafka just for the dev, so you have a way to produce message to kafka easily</p>
<h2 id="architecture-design">Architecture Design</h2>
<p><img src="https://user-images.githubusercontent.com/42219511/187194427-1f8f44ec-197d-4cca-86b6-1baf535ebf12.png" alt="image" class="img-responsive">
<img src="https://user-images.githubusercontent.com/42219511/187194566-ba5faeb2-8671-4c04-bb95-5eaa86c81da8.png" alt="image" class="img-responsive"></p>
<h2 id="scalability">Scalability</h2>
<p>Kafka:</p>
<ul>
<li>if we want to get the correct scale we have to run load test and increase the number of partition in function of the load test result</li>
</ul>
<p>Nestjs:</p>
<ul>
<li>we can deploy our server via kubernetes, and choose the right config for HorizontalPodAutoscaler, so we can increase our pod instances in function of cpu or memory utilisation</li>
</ul>
<p>Elasticsearch:</p>
<ul>
<li>about elasticsearch we could use a managed database</li>
</ul>





















                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 0;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'getting-started';
            var COMPODOC_CURRENT_PAGE_URL = 'index.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="./js/libs/custom-elements.min.js"></script>
       <script src="./js/libs/lit-html.js"></script>

       <script src="./js/menu-wc.js" defer></script>
       <script nomodule src="./js/menu-wc_es5.js" defer></script>

       <script src="./js/libs/bootstrap-native.js"></script>

       <script src="./js/libs/es6-shim.min.js"></script>
       <script src="./js/libs/EventDispatcher.js"></script>
       <script src="./js/libs/promise.min.js"></script>
       <script src="./js/libs/zepto.min.js"></script>

       <script src="./js/compodoc.js"></script>

       <script src="./js/tabs.js"></script>
       <script src="./js/menu.js"></script>
       <script src="./js/libs/clipboard.min.js"></script>
       <script src="./js/libs/prism.js"></script>
       <script src="./js/sourceCode.js"></script>
          <script src="./js/search/search.js"></script>
          <script src="./js/search/lunr.min.js"></script>
          <script src="./js/search/search-lunr.js"></script>
          <script src="./js/search/search_index.js"></script>
       <script src="./js/lazy-load-graphs.js"></script>


    </body>
</html>
